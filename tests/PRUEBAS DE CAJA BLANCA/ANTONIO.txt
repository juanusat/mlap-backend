⬜ PRUEBAS DE CAJA BLANCA (Formato 2)

Prueba CB-03

*Requisito
	-Módulo: Actos Litúrgicos
	-Tipo de requisito: Funcional
	-Código del requisito: RF19
	-Descripción del requisito: Gestionar horarios: Incluye la lógica de disponibilidad de la capilla, donde el horario específico prevalece sobre el horario general.
*Datos del caso de prueba
	-Código de prueba: CB-07
	-Fecha de prueba: 10/11/2025
	-Caso de prueba: Prueba unitaria de getChapelAvailability() con conflicto de horario
	-Complejidad de la prueba: 
	-Estado de la prueba: Terminado
	-Descripción de la prueba: Alta
	Probar unitariamente la función/método que determina la disponibilidad final de una capilla (getChapelAvailability) para una fecha específica. Se debe validar que si existe un specific_schedule de tipo 'CLOSED' para un día que normalmente está 'OPEN' en el general_schedule, el resultado final sea 'CLOSED'.
	-Datos de entrada: 
		-chapel_id: 5. 
		-date: 15/05/2026 (Viernes). 
		-Setup DB Pre-Prueba: general_schedule para Viernes (día 5): OPEN 08:00 a 18:00. specific_schedule para 15/05/2026: CLOSED todo el día.
	-Resultado Esperado: La función debe retornar que la capilla está CERRADA (CLOSED) para el 15/05/2026, validando la lógica de que la excepción específica anula el horario general.
	-Requerimientos de ambiente de pruebas: 
		-Entorno de desarrollo / Ejecución de Pruebas Unitarias. 
		-Acceso a la función de lógica de horarios. 
		-Mocks/Registros de la DB (general_schedule, specific_schedule).
	-Condiciones/Restricciones: 
		La función debe ser probada de forma aislada.
	-Pasos de la prueba:
		1. Configurar los datos de prueba en la base de datos (viernes abierto, pero 15/05/2026 cerrado). 
		2. Invocar getChapelAvailability(5, 15/05/2026). 
		3. Afirmar que el valor de retorno sea CLOSED. 
		4. (Prueba Secundaria): Remover el specific_schedule y afirmar que el retorno sea OPEN con el rango de 08:00 a 18:00.
		
*Seguimiento:
	-Veredicto: Conforme
	-Resultado obtenido: Conforme
	-Estado actual: Conforme
	-Observaciones funcionales: Establecer la documentación correspondiente

---

Prueba CB-04

*Requisito
	-Módulo: Reservas
	-Tipo de requisito: Funcional
	-Código del requisito: RF34
	-Descripción del requisito: Revisión de Código/SQL: Inspeccionar la consulta SQL de disponibilidad de horarios.
*Datos del caso de prueba
	-Código de prueba: CB-08
	-Fecha de prueba: 10/11/2025
	-Caso de prueba: Revisión de Consulta SQL para disponibilidad de reserva
	-Complejidad de la prueba: Media
	-Estado de la prueba: Terminado
	-Descripción de la prueba: Analizar el plan de ejecución de la consulta SQL que calcula la disponibilidad de cupos para una variante de evento en una fecha específica, buscando JOINS ineficientes, falta de índices y consultas N+1. 
	-Datos de entrada: 
		-Consulta SQL que une event_variant, reservation, chapel_event. 
		-Base de Datos con alto volumen de reservas (>10,000 registros).
	-Resultado Esperado: El plan de ejecución (EXPLAIN ANALYZE) debe mostrar el uso de índices en chapel_event_id y event_date de la tabla reservation. El tiempo de ejecución total debe ser inferior a 200ms.
	-Requerimientos de ambiente de pruebas: 
		-Herramienta de análisis de consultas SQL (EXPLAIN ANALYZE en PostgreSQL). 
		-Base de datos de pruebas con datos simulados de volumen.
	-Condiciones/Restricciones: Los índices deben existir y ser utilizados por el optimizador.
	-Pasos de la prueba:
		1. Ejecutar la consulta de disponibilidad usando EXPLAIN ANALYZE en un entorno de alto volumen. 
		2. Analizar el Plan de Ejecución: Verificar si se utilizan Seq Scan en lugar de Index Scan. 
		3. Medir el Tiempo de Ejecución. 
		4. Si es necesario, añadir o modificar índices y repetir los pasos 1-3.

*Seguimiento:
	-Resultado obtenido: 
		Código fuente sin documentación
	-Estado actual: Conforme
	-Observaciones funcionales: 

---